# 📚 Объяснение для начинающих (как для школьника)

## 🎯 Задача простыми словами

Представь, что в большой компании есть **3,590 компьютеров** (это называют АРМ - Автоматизированные Рабочие Места).

На каждом компьютере установлены разные программы. Всего разных программ - **1,349 штук**.

**Задача:** Перевести все эти компьютеры с Windows на Linux.

**Проблема:** Чтобы компьютер можно было перевести, нужно протестировать **ВСЕ** программы, которые на нём установлены.

**Вопрос:** Какие программы тестировать в первую очередь, чтобы перевести максимум компьютеров?

---

## 📊 Что такое входной Excel файл?

### Как выглядит файл

Представь большую таблицу в Excel:

```
┌────────────────┬──────────────────────┐
│ Компьютер (АРМ)│ Программа (ПО)       │
├────────────────┼──────────────────────┤
│ КОМПЬЮТЕР-1    │ Word                 │
│ КОМПЬЮТЕР-1    │ Excel                │
│ КОМПЬЮТЕР-1    │ Chrome               │
│ КОМПЬЮТЕР-2    │ Word                 │
│ КОМПЬЮТЕР-2    │ Excel                │
│ КОМПЬЮТЕР-2    │ Chrome               │
│ КОМПЬЮТЕР-3    │ Word                 │
│ КОМПЬЮТЕР-3    │ Chrome               │
│ КОМПЬЮТЕР-3    │ Photoshop            │
│ КОМПЬЮТЕР-4    │ Word                 │
│ КОМПЬЮТЕР-4    │ Chrome               │
│ ...            │ ...                  │
└────────────────┴──────────────────────┘
```

### Что это означает?

**Первый столбец (АРМ)** - это название компьютера.
- Например: WKMG5160014003

**Второй столбец (ПО)** - это название программы.
- Например: Microsoft Word, Google Chrome, Adobe Photoshop

**Каждая строка** - это факт: "На этом компьютере установлена эта программа"

### Ваш реальный файл

```
Имя: по_на_устройстве_09_07_2025_16_25_КГМК.xlsx
Строк: 112,017 (это очень много!)

Пример строки:
┌──────────────────┬────────────────────────────┐
│ АРМ              │ ПО                         │
├──────────────────┼────────────────────────────┤
│ WKMG5160014003   │ Microsoft Word             │
│ WKMG5160014003   │ Local Admin Password       │
│ WKMGHW1049190    │ K-Lite Codec Pack          │
│ WKZP2110003605   │ Microsoft Edge             │
│ ...              │ ...                        │
└──────────────────┴────────────────────────────┘
```

---

## 🔄 Что делает программа с этими данными?

### Шаг 1: Собираем "рюкзак" для каждого компьютера

Программа смотрит на все строки и собирает для каждого компьютера **полный список** его программ.

**Пример:**

```
Было в Excel:
┌──────────────┬──────────┐
│ КОМПЬЮТЕР-1  │ Word     │
│ КОМПЬЮТЕР-1  │ Excel    │
│ КОМПЬЮТЕР-1  │ Chrome   │
└──────────────┴──────────┘

Стало (собрали в "рюкзак"):
┌──────────────┬──────────────────────────┐
│ КОМПЬЮТЕР-1  │ {Word, Excel, Chrome}    │
└──────────────┴──────────────────────────┘
```

Так для КАЖДОГО из 3,590 компьютеров!

### Шаг 2: Удаляем повторы

Если на двух компьютерах ОДИНАКОВЫЙ набор программ - это один "рюкзак".

**Пример:**

```
КОМПЬЮТЕР-1: {Word, Excel, Chrome}
КОМПЬЮТЕР-2: {Word, Excel, Chrome}  ← Точно такой же!
КОМПЬЮТЕР-3: {Word, Chrome}         ← Другой набор

Итого: 2 уникальных "рюкзака"
```

**В вашем случае:**
- 3,590 компьютеров
- 3,189 уникальных "рюкзаков"
- Значит, некоторые компьютеры имеют одинаковые наборы программ

---

## 🎒 Что такое "набор ПО" или "комбинация"?

### Простыми словами

**Набор ПО** = полный список всех программ на одном компьютере.

Это как рюкзак: что лежит в рюкзаке компьютера?

### Примеры наборов

```
Набор №1: {Word, Excel, Chrome}
├─ Программа 1: Word
├─ Программа 2: Excel
└─ Программа 3: Chrome

Набор №2: {Word, Chrome, Photoshop}
├─ Программа 1: Word
├─ Программа 2: Chrome
└─ Программа 3: Photoshop

Набор №3: {Word}
└─ Программа 1: Word (только одна!)
```

### Почему это важно?

Если у 10 компьютеров **одинаковый набор** {Word, Excel, Chrome}, значит:
- Протестировав эти 3 программы
- Мы сразу сможем перевести все 10 компьютеров!

Не нужно работать с каждым компьютером отдельно.

---

## ⚙️ Как работает алгоритм?

### Правило миграции

```
╔═══════════════════════════════════════════════════╗
║  Компьютер можно перевести на Linux ТОЛЬКО        ║
║  если протестированы ВСЕ его программы!           ║
╚═══════════════════════════════════════════════════╝
```

### Пример с 4 компьютерами

```
Дано:
┌──────────────┬─────────────────────────┐
│ Компьютер    │ Программы               │
├──────────────┼─────────────────────────┤
│ КОМП-1       │ {Word, Excel}           │
│ КОМП-2       │ {Word, Excel}           │
│ КОМП-3       │ {Word, Chrome}          │
│ КОМП-4       │ {Word, Excel, Skype}    │
└──────────────┴─────────────────────────┘

Уникальных программ: 4 (Word, Excel, Chrome, Skype)
```

### Вариант 1: Тестируем 2 самые популярные программы

```
Считаем популярность:
- Word: на 4 компьютерах   ← Самая популярная!
- Excel: на 3 компьютерах  ← Вторая!
- Chrome: на 1 компьютере
- Skype: на 1 компьютере

Тестируем: Word, Excel

Результат:
┌──────────┬─────────────────┬─────────────┐
│ Компьютер│ Программы       │ Мигрирует?  │
├──────────┼─────────────────┼─────────────┤
│ КОМП-1   │ {Word, Excel}   │ ✅ ДА       │
│ КОМП-2   │ {Word, Excel}   │ ✅ ДА       │
│ КОМП-3   │ {Word, Chrome}  │ ❌ НЕТ      │ ← Chrome не протестирован
│ КОМП-4   │ {Word,Excel,Skype}│ ❌ НЕТ    │ ← Skype не протестирован
└──────────┴─────────────────┴─────────────┘

Итого: 2 компьютера из 4 = 50%
```

### Вариант 2: Наш умный алгоритм

Алгоритм думает по-другому:

```
Шаг 1: Смотрит на наборы программ

Набор А: {Word, Excel} - нужен для КОМП-1 и КОМП-2 (2 компьютера)
Набор Б: {Word, Chrome} - нужен для КОМП-3 (1 компьютер)
Набор В: {Word, Excel, Skype} - нужен для КОМП-4 (1 компьютер)

Шаг 2: Выбирает программу

Первая программа: Какая даст максимум компьютеров?
- Word: закроет 0 компьютеров (всем нужно больше программ)
- Excel: закроет 0 компьютеров
- Chrome: закроет 0 компьютеров
- Пока никакая не даёт полного набора...

Вторая программа (с учётом уже выбранных):
Если выберем Word + Excel:
  → Закроет КОМП-1 и КОМП-2 (2 компьютера!) ✓

Если выберем Word + Chrome:
  → Закроет КОМП-3 (1 компьютер)

Алгоритм выбирает: Word, Excel (лучший результат!)
```

В этом примере оба подхода дали одинаковый результат, НО...

### Более сложный пример

```
Дано: 10 компьютеров

КОМП 1-5:  {Программа_A, Программа_B}      (5 компьютеров)
КОМП 6-10: {Программа_C, Программа_D}      (5 компьютеров)

Лимит: можем протестировать только 2 программы

Вариант 1 (популярные):
Считаем: A и C самые популярные (по 5 раз)
Тестируем: {A, C}
Результат: 0 компьютеров мигрирует! ❌
(у всех не хватает по одной программе)

Вариант 2 (умный):
Алгоритм видит:
- Набор {A, B} закроет 5 компьютеров
- Набор {C, D} закроет 5 компьютеров
Выбирает: {A, B} или {C, D}
Результат: 5 компьютеров мигрирует! ✅
```

**Вот в чём разница!**

---

## 📈 Метрики простыми словами

### 1. Всего АРМ (компьютеров)

```
В файле: WKMG5160014003, WKMGHW1049190, WKZP2110003605, ...

Программа считает уникальные имена компьютеров.

Ваш результат: 3,590 компьютеров
```

### 2. Всего уникального ПО (программ)

```
В файле: Word, Excel, Chrome, Photoshop, Skype, ...

Программа считает уникальные названия программ.

Ваш результат: 1,349 программ
```

### 3. Уникальных наборов ПО

```
Это количество РАЗНЫХ "рюкзаков" программ.

Пример:
Рюкзак №1: {Word, Excel} - на 100 компьютерах
Рюкзак №2: {Word, Chrome} - на 50 компьютерах
Рюкзак №3: {Word, Excel, Chrome} - на 30 компьютерах
...
Рюкзак №3189: {какой-то редкий набор} - на 1 компьютере

Ваш результат: 3,189 разных "рюкзаков"

Это меньше, чем 3,590 компьютеров!
Значит, некоторые компьютеры имеют одинаковые наборы.
```

### 4. Среднее ПО на АРМ

```
Сколько в среднем программ на одном компьютере?

Формула:
Все строки в файле / Количество компьютеров
112,017 строк / 3,590 компьютеров = 31.2 программы

Это значит:
- Если взять случайный компьютер
- На нём будет примерно 31 программа
```

### 5. Покрыто АРМ (после расчёта)

```
Сколько компьютеров СМОГУТ мигрировать?

Пример:
Выбрали для тестирования: {Word, Excel, Chrome, Firefox}

Проверяем каждый компьютер:

КОМП-1: {Word, Excel}
  Все программы есть в плане? ✅ ДА
  Мигрирует? ✅ ДА

КОМП-2: {Word, Excel, Skype}
  Все программы есть в плане? ❌ НЕТ (Skype нет)
  Мигрирует? ❌ НЕТ

КОМП-3: {Chrome}
  Все программы есть в плане? ✅ ДА
  Мигрирует? ✅ ДА

Покрыто: 2 из 3 компьютеров

Ваш результат (пример): 3,420 из 3,590 = 95.2%
```

### 6. ПО в плане

```
Сколько программ мы выбрали для тестирования?

Пример:
Волна 1: тестируем 100 программ
Волна 2: тестируем ещё 150 программ
Волна 3: тестируем ещё 100 программ

Всего в плане: 100 + 150 + 100 = 350 программ

Ваш результат (пример): 680 программ из 1,349 = 50.4%
```

### 7. Процент покрытия АРМ

```
Какая доля компьютеров мигрирует?

Формула:
(Покрытых компьютеров / Всего компьютеров) × 100%

Пример:
(3,420 / 3,590) × 100% = 95.2%

Что это значит:
🟢 95.2% компьютеров - мигрируют
🔴 4.8% компьютеров - НЕ мигрируют (редкое ПО)

Оценка:
✅ >90% = ОТЛИЧНО!
⚠️ 70-90% = Хорошо
❌ <70% = Мало, нужно больше программ
```

### 8. Процент использования ПО

```
Какую долю ВСЕХ программ мы тестируем?

Формула:
(ПО в плане / Всего уникального ПО) × 100%

Пример:
(680 / 1,349) × 100% = 50.4%

Что это значит:
Мы тестируем ПОЛОВИНУ всех программ
И при этом покрываем 95% компьютеров!

Это ОТЛИЧНО! Закон Парето:
50% усилий → 95% результата! 🎯
```

---

## 🎮 Пример на игрушечных данных

Давай разберём на совсем простом примере!

### Исходные данные

```
У нас есть 6 компьютеров в школе:
┌──────────┬──────────────────────┐
│Компьютер │ Программы            │
├──────────┼──────────────────────┤
│ КОМП-1   │ {Word, Paint}        │
│ КОМП-2   │ {Word, Paint}        │
│ КОМП-3   │ {Word, Paint}        │
│ КОМП-4   │ {Excel, Chrome}      │
│ КОМП-5   │ {Excel, Chrome}      │
│ КОМП-6   │ {Word, Paint, Excel} │
└──────────┴──────────────────────┘
```

### Шаг 1: Подсчёт базовых метрик

```
Всего компьютеров: 6

Всего уникальных программ: 4
  - Word
  - Paint
  - Excel
  - Chrome

Уникальных наборов: 3
  Набор А: {Word, Paint} - на КОМП-1, 2, 3 (3 компьютера)
  Набор Б: {Excel, Chrome} - на КОМП-4, 5 (2 компьютера)
  Набор В: {Word, Paint, Excel} - на КОМП-6 (1 компьютер)

Среднее ПО на компьютер:
  КОМП-1: 2 программы
  КОМП-2: 2 программы
  КОМП-3: 2 программы
  КОМП-4: 2 программы
  КОМП-5: 2 программы
  КОМП-6: 3 программы
  Среднее: (2+2+2+2+2+3) / 6 = 2.17 программы
```

### Шаг 2: Планируем волны

Можем протестировать 2 программы в первой волне.

```
Вариант 1: Самые популярные

Популярность:
- Word: 4 раза   ← Самая популярная
- Paint: 4 раза  ← Вторая
- Excel: 3 раза
- Chrome: 2 раза

Тестируем: {Word, Paint}

Проверяем:
КОМП-1: {Word, Paint} ✅ Все программы в плане → МИГРИРУЕТ
КОМП-2: {Word, Paint} ✅ Все программы в плане → МИГРИРУЕТ
КОМП-3: {Word, Paint} ✅ Все программы в плане → МИГРИРУЕТ
КОМП-4: {Excel, Chrome} ❌ Excel и Chrome НЕ в плане → НЕ МИГРИРУЕТ
КОМП-5: {Excel, Chrome} ❌ Excel и Chrome НЕ в плане → НЕ МИГРИРУЕТ
КОМП-6: {Word,Paint,Excel} ❌ Excel НЕ в плане → НЕ МИГРИРУЕТ

Результат: 3 из 6 = 50%
```

```
Вариант 2: Умный алгоритм

Алгоритм анализирует наборы:
  Набор А {Word, Paint}: 2 программы → 3 компьютера ✨
  Набор Б {Excel, Chrome}: 2 программы → 2 компьютера

Алгоритм выбирает: {Word, Paint}
(Тот же результат в этом простом случае)

Результат: 3 из 6 = 50%
```

### Шаг 3: Вторая волна

Тестируем ещё 2 программы: {Excel, Chrome}

```
Теперь протестировано: {Word, Paint, Excel, Chrome}

Проверяем:
КОМП-1: {Word, Paint} ✅ → МИГРИРУЕТ
КОМП-2: {Word, Paint} ✅ → МИГРИРУЕТ
КОМП-3: {Word, Paint} ✅ → МИГРИРУЕТ
КОМП-4: {Excel, Chrome} ✅ Теперь все есть! → МИГРИРУЕТ
КОМП-5: {Excel, Chrome} ✅ Теперь все есть! → МИГРИРУЕТ
КОМП-6: {Word,Paint,Excel} ✅ Теперь все есть! → МИГРИРУЕТ

Результат: 6 из 6 = 100%! 🎉
```

### Итоговая статистика

```
╔═══════════════════════════════════════╗
║  СТАТИСТИКА ПО ШКОЛЬНЫМ КОМПЬЮТЕРАМ  ║
╠═══════════════════════════════════════╣
║  Всего компьютеров: 6                 ║
║  Уникального ПО: 4                    ║
║  Уникальных наборов: 3                ║
║  Среднее ПО/компьютер: 2.17           ║
║                                       ║
║  После 2 волн:                        ║
║  ПО в плане: 4 (100% всего ПО)        ║
║  Покрыто: 6 компьютеров (100%)        ║
╚═══════════════════════════════════════╝

Волна 1: {Word, Paint}
  → 3 компьютера (50%)

Волна 2: {Excel, Chrome}
  → +3 компьютера (50%)
  → Всего: 6 (100%)
```

---

## 🔍 Почему это работает?

### Ключевая идея: Группировка

```
ПЛОХО - Работать с каждым компьютером отдельно:
┌────────┬─────────────┐
│ КОМП-1 │ Word, Paint │
│ КОМП-2 │ Word, Paint │  } Одинаковые! Зачем 3 раза
│ КОМП-3 │ Word, Paint │  } думать об одном и том же?
└────────┴─────────────┘

ХОРОШО - Группировать одинаковые:
┌────────────────┬─────────────┬──────────────┐
│ Набор          │ Программы   │ Компьютеров  │
├────────────────┼─────────────┼──────────────┤
│ Группа А       │ Word, Paint │ 3 штуки      │
│ Группа Б       │ Excel,Chrome│ 2 штуки      │
│ Группа В       │ Word,Paint, │ 1 штука      │
│                │ Excel       │              │
└────────────────┴─────────────┴──────────────┘

Теперь работаем с 3 группами вместо 6 компьютеров!
```

В вашем случае:
- 3,590 компьютеров → 3,189 групп
- Экономия: ~11% меньше вычислений!

---

## 🎯 Закон Парето (Принцип 80/20)

### Что это?

```
В реальной жизни обычно:
20% причин → 80% результата

В нашем случае:
50% программ → 95% компьютеров

Это ОЧЕНЬ хорошо!
```

### Почему так?

Представь программы как слои пирамиды:

```
        ⭐ Редкие программы
       ╱  ╲  (5% компьютеров)
      ╱    ╲  50% программ
     ╱──────╲
    ╱        ╲ Популярные программы
   ╱          ╲ (95% компьютеров)
  ╱____________╲ 50% программ
```

**Популярные программы** (Word, Excel, Chrome):
- Мало программ
- Много компьютеров

**Редкие программы** (какая-нибудь специализированная программа):
- Много разных программ
- Мало компьютеров (1-2 штуки)

Поэтому:
- Протестировав половину (популярные)
- Мы покрываем почти все компьютеры!

---

## ❓ Частые вопросы простыми словами

### 1. Почему не 100% компьютеров?

```
Потому что некоторые компьютеры имеют ОЧЕНЬ редкие программы.

Пример:
998 компьютеров: обычные программы
1 компьютер: Word + Excel + РедкаяПрограммаИзОднойКомпании
1 компьютер: Chrome + ДругаяРедкаяПрограмма

Чтобы перевести эти 2 компьютера, нужно:
- Протестировать 2 редкие программы
- Которые больше НИ НА ОДНОМ компьютере нет

Это дорого и долго для всего 2 компьютеров.
Проще перевести их отдельно позже.
```

### 2. Что лучше: много волн или мало?

```
Мало волн с большими лимитами:
  Волна 1: 300 программ
  Волна 2: 300 программ
  + Быстро переводим много компьютеров
  - Долго тестировать каждую волну

Много волн с малыми лимитами:
  Волна 1: 100 программ
  Волна 2: 100 программ
  Волна 3: 100 программ
  Волна 4: 100 программ
  + Короткие циклы тестирования
  - Медленнее общий прогресс

Оптимально: 3-4 волны
```

### 3. Как улучшить результат?

```
Если покрытие 80% (мало):

Способ 1: Увеличить лимиты
  Было: 3 волны по 100 программ
  Стало: 3 волны по 150 программ
  Результат: +10-15% покрытия

Способ 2: Добавить волну
  Было: 3 волны
  Стало: 4 волны
  Результат: +5-10% покрытия

Способ 3: И то, и то
  4 волны по 150 программ
  Результат: +20% покрытия
```

---

## 🎓 Резюме для школьника

### Что делает программа?

1. **Читает Excel файл**
   - Столбец 1: Компьютеры
   - Столбец 2: Программы

2. **Собирает "рюкзаки"**
   - Для каждого компьютера: какие программы установлены

3. **Группирует одинаковые**
   - Если рюкзаки одинаковые → одна группа

4. **Умно выбирает программы**
   - Какие программы протестировать, чтобы максимум компьютеров мигрировало

5. **Показывает результаты**
   - Сколько компьютеров мигрирует
   - Сколько программ нужно тестировать

### Главное правило

```
╔═══════════════════════════════════════════════════╗
║  Компьютер мигрирует ⟺ ВСЕ его программы в плане ║
╚═══════════════════════════════════════════════════╝
```

Даже если не хватает ОДНОЙ программы - компьютер НЕ мигрирует!

### Ваши результаты

```
📊 Ваши данные:
   - 3,590 компьютеров
   - 1,349 программ
   - В среднем 31 программа на компьютер

🎯 Результат (пример):
   - Тестируем 680 программ (50%)
   - Мигрирует 3,420 компьютеров (95%)

✨ Эффективность:
   50% усилий → 95% результата
   Это ОТЛИЧНО!
```

---

📖 **Теперь можешь запустить приложение и попробовать!**
🚀 **Файл для запуска:** `run.bat`
